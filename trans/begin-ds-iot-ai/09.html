<html lang="en">
<head><title>Using Wi-Fi to Connect to the Internet</title>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<link href="../css/springer_epub.css" rel="styleSheet" type="text/css"/>
</head>
<body>
 
<!--Begin Abstract--><h1 class="ChapterTitle" lang="en">9.使用 Wi-Fi 连接到互联网</h1>

 
<!--End Abstract--><p class="Para" id="Par2">在第<strong class="EmphasisTypeBold ">章</strong> <a href="06.html"> <strong class="EmphasisTypeBold "> 6 </strong> </a>中，我们看到能够将我们的实验连接到互联网有可能极大地增强我们的数据科学工具包。在第<strong class="EmphasisTypeBold ">章</strong> <a href="07.html"> <strong class="EmphasisTypeBold "> 7 </strong> </a>和<strong class="EmphasisTypeBold ">章</strong> <a href="08.html"> <strong class="EmphasisTypeBold "> 8 </strong> </a>中，我们查看了 micro:bit 上的功能是否可以将我们连接到云，让我们访问那里可用的服务。尽管 BLE 和 micro:bit 无线电都提供了一些真正有用的无线功能，但我们仍然没有比几章前更接近于正确连接到物联网。是时候超越 micro:bit 的固有功能了。</p>
<p class="Para" id="Par3">如今，连接到物联网相对简单，最常见的是使用 Wi-Fi。<sup> <a epub:type="noteref" href="#Fn1" id="Fn1_source" role="doc-noteref"> 1 </a> </sup>本章我们将为我们的 micro:bit 气象站添加 Wi-Fi，并将其连接到云端。</p>
<h2 class="Heading">9.1 定义我们的物联网气象站</h2>
<p>仅仅是在我们的 micro:bit 气象站中加入 Wi-Fi 就很好，但这实际上意味着什么:我们将要建造的是什么？我们需要更清楚地了解我们希望这个系统如何运作:</p>
<ol><li class="ListItem"><p class="Para" id="Par7">我们的微型气象站不会有太大变化:我们将记录温度、湿度和压力数据。这次我们将通过 Wi-Fi 输出数据。</p>
 </li>
<li class="ListItem"><p class="Para" id="Par8">我们将把 micro:bit 气象站连接到物联网平台。</p>
 </li>
<li class="ListItem"><p class="Para" id="Par9">我们会将天气数据发送到物联网平台。</p>
 </li>
<li class="ListItem"><p class="Para" id="Par10">当数据进入平台后，我们将可以使用许多工具/服务。我们将构建一个图表，实时显示数据并将其与历史数据进行比较。</p>
 </li>
</ol>

<p class="Para" id="Par11">正如我们在第<strong class="EmphasisTypeBold ">章</strong> <a href="06.html"> <strong class="EmphasisTypeBold "> 6 </strong> </a>中看到的那样，一旦数据进入我们的物联网平台，我们将可以访问一系列工具，用于我们的数据科学事业。在<strong class="EmphasisTypeBold ">第 9.4 节</strong>中，我们将建立我们的物联网平台，但首先我们将整理出我们需要的硬件。</p>

<h2 class="Heading">9.2 建设我们的 Wi-Fi 气象站</h2>
<p>除了我们在<strong class="EmphasisTypeBold ">章节</strong> <a href="08.html"> <strong class="EmphasisTypeBold "> 8 </strong> </a>中使用的硬件，我们还需要引入一个提供 Wi-Fi 连接的模块。<strong class="EmphasisTypeBold ">图</strong> <a href="#Fig1"> <strong class="EmphasisTypeBold "> 9-1 </strong> </a>显示了支持 Wi-Fi 的数字气象站仪器的框图。</p>
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig1_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig1_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-1</p><p class="SimplePara">支持 Wi-Fi 的气象站工具所需的组件</p>


<p><strong class="EmphasisTypeBold ">表</strong> <a href="#Tab1"> <strong class="EmphasisTypeBold "> 9-1 </strong> </a>列出了我们用来构建 micro:bit 气象站边缘设备的具体硬件。</p>
<p>表 9-1</p><p class="SimplePara">micro:bit 气象站边缘设备的硬件建议</p>


<table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="tcol1 align-left"/>
<col class="tcol2 align-left"/>
<col class="tcol3 align-left"/>
<col class="tcol4 align-left"/>
</colgroup>
<thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">你需要什么</p>
</th>
<th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">我们用什么</p>
</th>
<th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">数量</p>
</th>
<th style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">可供选择的事物</p>
</th>
</tr>
</thead>
<tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">一个微处理器和闪存代码的方法</p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">微型:带 micro-B USB 电缆的 bit</p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">one</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">树莓派</p>
<p class="SimplePara">赛车场</p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">力量</p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">通过 XinaBox IM01 的 USB 电源组</p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">one</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">XinaBox PB01–双 AA 电池电源组</p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">读取天气数据的传感器</p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">XinaBox SW01 天气传感器</p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">one</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">SparkFun Weatherbit</p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Wi-Fi 核心</p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">中国盒 CW01 无线局域网</p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">one</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">SparkFun ESP32 的东西</p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">查看数据的屏幕</p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">微型:5x5 位 LED 矩阵</p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">one</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">XinaBox OD01–64x 128 有机发光二极管显示器</p>
</td>
</tr>
<tr><td rowspan="2" style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">将它们连接在一起的方法</p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">XinaBox IM01–微型:位桥</p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">one</p>
</td>
<td rowspan="2" style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">试验板、边缘连接器分线点、鳄鱼/鳄鱼线和连接线</p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">xBus 连接器</p>
</td>
<td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">Two</p>
</td>
</tr>
</tbody>
</table>

<p><strong class="EmphasisTypeBold ">图</strong> <a href="#Fig2"> <strong class="EmphasisTypeBold "> 9-2 </strong> </a>显示 micro:bit 气象站边缘设备组装后的样子。</p>
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig2_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig2_HTML.jpg" style="width:15em"/></p>
<p>图 9-2</p><p class="SimplePara">带 Wi-Fi 的微型比特气象站</p>



<h2 class="Heading">9.3 更新固件</h2>
<p class="Para" id="Par15"><strong class="EmphasisTypeBold ">固件</strong>是作为其操作系统的微处理器上的计算机程序。我们编写的代码(在 MakeCode/MicroPython 中)和闪存到我们的 micro:bits 上的代码是固件解释的一组指令:我们的程序告诉固件做什么。</p>
<p class="Para" id="Par16">BBC micro:bit 大约在 5 年前首次发布，在那段时间里，它并没有真正改变。早期版本的 micro:bit 固件不支持 Wi-Fi:您可能需要更新您的固件，不仅是为了本章，也是为了第<strong class="EmphasisTypeBold ">章</strong> <a href="11.html"> <strong class="EmphasisTypeBold "> 11 </strong> </a>中的示例。</p>
<p class="Para" id="Par17">这是一个很好的做法，以确保您的固件总是最新的，所以如果你最近没有更新它，我们建议你在继续之前这样做。这非常简单:只需将一个文件刷新到 micro:bit 上，就能确保所有最新版本和高级功能在您的 micro:bit 上正常工作。你可以在我们的资源网站上找到完整的说明，或者在 Micro:bit 基金会的网站上。</p>
<p>虽然我们只用它的 Wi-Fi 功能，但来自 XinaBox 的 CW01 也是一款微处理器；它也加载了固件。要将 CW01 与 micro:bit 配合使用，必须确保其运行正确的固件。尽管大多数阅读器不需要更新固件；这完全取决于您从哪里获得 CW01:</p>
<ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par19">如果 CW01 是 XinaBox XK05 套件的一部分，则不需要更新。</p></li>
<li><p class="Para" id="Par20">如果您单独购买了 CW01，或者它附带了不同的套件(例如 XK01)，您将需要更新它。</p></li>
</ul>

<p>我们的资源网站上提供了更新 CW01 固件的完整说明。</p><blockquote class="BlockQuote"><p class="Para ParaOneEmphasisChild" id="Par22">在继续之前，请确保 micro:bit 和 CW01 运行合适的固件。</p>
</blockquote>


<h2 class="Heading">9.4 选择物联网平台</h2>
<p class="Para" id="Par23">建设物联网气象站，需要选择一个物联网平台来使用。有一系列的选择，有些比其他的更简单。</p>
<p class="Para" id="Par24">来自 XinaBox 的 CW01 Wi-Fi 模块的 MakeCode 扩展具有定制的块，可以轻松连接到 Ubidots、ATT 和 Azure。它还具有“通用”MQTT <sup> <a epub:type="noteref" href="#Fn2" id="Fn2_source" role="doc-noteref"> 2 </a> </sup>块，允许您连接到任何遵循 MQTT 标准的物联网平台。</p>
<p>出于以下原因，我们将使用<strong class="EmphasisTypeBold "> IBM Cloud </strong>作为范例:</p>
<ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par27">我们不得不选择一个，IBM 一直处于物联网的最前沿。</p></li>
<li><p class="Para" id="Par28">展示如何在 MakeCode 中使用 MQTT 块将使您能够更好地连接到任何物联网平台。定制的块更容易使用，但只能与定制的物联网平台一起使用。</p></li>
<li><p class="Para" id="Par29">您将可以访问广泛的 IBM 云服务(包括 IBM Watson AI 服务)。</p></li>
<li><p class="Para" id="Par30">他们提供 28 天免费服务，所以你可以免费测试。</p></li>
</ul>

<p class="Para" id="Par31">要注册 IBM Cloud，你需要有一个<strong class="EmphasisTypeBold "> IBMid </strong>。这允许您登录所有 IBM 产品和服务。如果您还没有电子邮件地址，以下步骤将解释如何使用您的电子邮件地址注册:</p>
Warning
<p class="Para FirstParaInFormalPara" id="Par32">我们发现 outlook 电子邮件地址不能用于创建 IBM Cloud 帐户。Gmail 管用。</p>

<p>
 
</p>
<ul class="UnorderedListMarkBullet"><li>Go to the IBM Cloud login page (<a href="https://cloud.ibm.com/login"><code>https://cloud.ibm.com/login</code></a>), and click <strong class="EmphasisTypeBold ">Create an IBM Cloud account</strong> (<strong class="EmphasisTypeBold ">Figure</strong> <a href="#Fig3"><strong class="EmphasisTypeBold ">9-3</strong></a>). 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig3_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig3_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-3</p><p class="SimplePara">IBM Cloud 登录页面</p>


</li>
<li><p class="Para" id="Par35">输入您的<strong class="EmphasisTypeBold ">电子邮件地址</strong>。</p></li>
<li><p class="Para" id="Par36">填写剩余字段，然后点击<strong class="EmphasisTypeBold ">创建账户</strong>。</p></li>
<li>The next page will show you if your account has been created successfully (<strong class="EmphasisTypeBold ">Figure</strong> <a href="#Fig4"><strong class="EmphasisTypeBold ">9-4</strong></a>). 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig4_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig4_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-4</p><p class="SimplePara">帐户创建成功消息</p>


</li>
<li><p class="Para" id="Par38">检查您的电子邮件，然后在发送给您的确认电子邮件中点击<strong class="EmphasisTypeBold ">确认帐户</strong>来确认您的帐户。</p></li>
<li><p class="Para" id="Par39">您将被带到登录页面。点击<strong class="EmphasisTypeBold ">登录</strong>继续。</p></li>
<li><p class="Para" id="Par40">您将被重定向到<strong class="EmphasisTypeBold ">关于您的 IBMid 帐户隐私</strong>页面。在向下滚动页面找到<strong class="EmphasisTypeBold ">继续</strong>按钮之前，确保您对隐私政策满意。</p></li>
<li>You will be automatically logged in to the <strong class="EmphasisTypeBold ">IBM Cloud Dashboard</strong> (<strong class="EmphasisTypeBold ">Figure</strong> <a href="#Fig5"><strong class="EmphasisTypeBold ">9-5</strong></a>). 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig5_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig5_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-5</p><p class="SimplePara">IBM 云仪表板</p>


</li>
</ul>

<p class="Para" id="Par42">IBM Cloud Dashboard 是您可以访问所有 IBM 产品和服务的中心。</p>

<h2 class="Heading">9.5 建立物联网平台</h2>
<p>我们将连接 micro:bit 气象站的服务被恰当地命名为<strong class="EmphasisTypeBold "> IBM 物联网平台</strong>，它可以从 IBM Cloud Dashboard 访问，如下所述:</p>
<ul class="UnorderedListMarkBullet"><li>In the IBM Cloud Dashboard, click <strong class="EmphasisTypeBold ">Create resource</strong> (<strong class="EmphasisTypeBold ">Figure</strong> <a href="#Fig6"><strong class="EmphasisTypeBold ">9-6</strong></a>). 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig6_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig6_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-6</p><p class="SimplePara">使用 IBM Cloud Dashboard 创建新资源</p>


</li>
<li>In the <strong class="EmphasisTypeBold ">Catalog</strong> page, select <strong class="EmphasisTypeBold ">Internet of Things</strong> from the Services list. Then select <strong class="EmphasisTypeBold ">Internet of Things Platform</strong> from the filtered result (<strong class="EmphasisTypeBold ">Figure</strong> <a href="#Fig7"><strong class="EmphasisTypeBold ">9-7</strong></a>). 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig7_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig7_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-7</p><p class="SimplePara">选择物联网平台服务</p>


</li>
<li><p class="Para" id="Par46">选择<strong class="EmphasisTypeBold "> Lite 计划</strong>。</p></li>
<li>Scroll down the page and rename the service name (e.g., <strong class="EmphasisTypeBold ">Weather Service</strong>) (<strong class="EmphasisTypeBold ">Figure</strong> <a href="#Fig8"><strong class="EmphasisTypeBold ">9-8</strong></a>). 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig8_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig8_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-8</p><p class="SimplePara">重命名默认服务名</p>


</li>
<li><p class="Para" id="Par48">点击<strong class="EmphasisTypeBold ">创建</strong>。几秒钟后，服务将被创建。</p></li>
<li>Click <strong class="EmphasisTypeBold ">Launch</strong> (<strong class="EmphasisTypeBold ">Figure</strong> <a href="#Fig9"><strong class="EmphasisTypeBold ">9-9</strong></a>). 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig9_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig9_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-9</p><p class="SimplePara">我们天气服务的启动页面</p>


</li>
<li><p class="Para" id="Par50">这将把您重定向到<strong class="EmphasisTypeBold "> IBM Watson 物联网平台</strong>，我们将在下一节中设置它。</p></li>
</ul>


<h2 class="Heading">9.6 将我们的气象站添加到物联网平台</h2>
<p class="Para" id="Par51">我们现在已经建立了一个物联网平台，我们将把我们的 micro:bit 气象站连接到该平台。我们仍然需要配置它，但是基本的基础设施已经就绪。</p>
<p>配置物联网平台的第一步是确定允许连接的设备。以下步骤将实现这一目标:</p>
<ul class="UnorderedListMarkBullet"><li>Click <strong class="EmphasisTypeBold ">Add Device</strong> at the top right of the page (<strong class="EmphasisTypeBold ">Figure</strong> <a href="#Fig10"><strong class="EmphasisTypeBold ">9-10</strong></a>). 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig10_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig10_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-10</p><p class="SimplePara">添加新设备</p>


</li>
<li>在<strong class="EmphasisTypeBold ">添加设备</strong>窗口中，输入设备的名称和唯一 ID，然后点击<strong class="EmphasisTypeBold ">下一步</strong> ( <strong class="EmphasisTypeBold ">图</strong> <a href="#Fig11"> <strong class="EmphasisTypeBold "> 9-11 </strong> </a>)。我们使用了下列详细信息:<ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par55"><strong class="EmphasisTypeBold ">设备类型</strong> : <em class="EmphasisTypeItalic "> XinaBox </em></p></li>
<li><strong class="EmphasisTypeBold ">Device ID</strong>: <em class="EmphasisTypeItalic ">xb123456</em> 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig11_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig11_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-11</p><p class="SimplePara">添加设备的第 1 步</p>


</li>
</ul>

</li>
<li><p class="Para" id="Par57">在<strong class="EmphasisTypeBold ">设备信息</strong>选项卡中，将所有设备信息留空，点击<strong class="EmphasisTypeBold ">下一步</strong>。</p></li>
<li><p class="Para" id="Par58">在<strong class="EmphasisTypeBold ">安全</strong>选项卡中，将<strong class="EmphasisTypeBold ">认证令牌</strong>留空(让认证令牌自动生成)。点击<strong class="EmphasisTypeBold ">下一个</strong>。</p></li>
<li><p class="Para" id="Par59">在<strong class="EmphasisTypeBold ">总结</strong>页签中，点击<strong class="EmphasisTypeBold ">完成</strong>。</p></li>
<li><p class="Para" id="Par60">下一页显示的是<strong class="EmphasisTypeBold ">设备凭证</strong> ( <strong class="EmphasisTypeBold ">图</strong><a href="#Fig12">T5】9-12</a>)。</p></li>
</ul>

Warning
<p class="Para FirstParaInFormalPara" id="Par61">不清楚离开该页面后如何检索身份验证令牌。请记住拍摄该页面的屏幕截图或在纸上写下设备凭据。当您构建代码时，您将需要它们。</p>

<p> 
</p>
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig12_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig12_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-12</p><p class="SimplePara">我们刚刚添加的设备的设备凭据</p>


<p>
 
</p>
<ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par63">点击页面左上方的<strong class="EmphasisTypeBold ">后退</strong>查看所有已添加的设备。您的设备将显示在设备列表中。</p></li>
<li>Click <strong class="EmphasisTypeBold ">Security</strong> in the left navigation (<strong class="EmphasisTypeBold ">Figure</strong> <a href="#Fig13"><strong class="EmphasisTypeBold ">9-13</strong></a>). 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig13_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig13_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-13</p><p class="SimplePara">左侧菜单中有“安全”选项卡</p>


</li>
<li>In the <strong class="EmphasisTypeBold ">Policies</strong> page, click <strong class="EmphasisTypeBold ">edit</strong> to edit the <strong class="EmphasisTypeBold ">Connection Security</strong> (<strong class="EmphasisTypeBold ">Figure</strong> <a href="#Fig14"><strong class="EmphasisTypeBold ">9-14</strong></a>). 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig14_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig14_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-14</p><p class="SimplePara">策略页面</p>


</li>
<li>Choose <strong class="EmphasisTypeBold ">TLS Optional</strong> from the <strong class="EmphasisTypeBold ">Security Level</strong> drop-down list (<strong class="EmphasisTypeBold ">Figure</strong> <a href="#Fig15"><strong class="EmphasisTypeBold ">9-15</strong></a>). Then click <strong class="EmphasisTypeBold ">Save</strong> at the top right. 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig15_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig15_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-15</p><p class="SimplePara">为默认规则选择的安全级别适用于您的所有设备</p>


</li>
</ul>

<p class="Para" id="Par67">在<strong class="EmphasisTypeBold ">第 9.5 节</strong>中，我们设置了“物联网应用”的外壳，在这一节中，我们定义了与我们要连接的设备相关的关键参数。剩下的就是告诉我们的物联网应用程序如何处理我们将从该设备发送给它的数据。</p>

<h2 class="Heading">9.7 在物联网平台中可视化数据</h2>
<p class="Para" id="Par68">在本节中，我们将告诉我们的物联网平台如何处理数据以及如何输出/显示数据。我们将建立一个可视化:折线图。</p>
<p class="Para" id="Par69">IBM Watson 允许我们建立虚拟的“图钉板”,我们可以在上面添加各种不同的内容。稍后，当一切顺利运行时，我们将能够从浏览器中查看这些插针板(称为<strong class="EmphasisTypeBold ">板</strong>)。</p>
<p class="Para" id="Par70">我们添加到板上的内容被称为<strong class="EmphasisTypeBold ">卡片</strong>。卡片是预定义的项目(如折线图)，用于显示我们物联网平台中定义的设备的数据或相关数据。我们可以在一块板上添加多张卡。在本节中，我们将在沃森物联网仪表板中创建一个新的<strong class="EmphasisTypeBold ">板</strong>，然后向其添加一个<strong class="EmphasisTypeBold ">卡</strong>。</p>
<p>使用以下步骤添加新板:</p>
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig17_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig17_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-17</p><p class="SimplePara">新创建的板显示在您的板下</p>


<ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par72">点击左侧导航栏中的<strong class="EmphasisTypeBold ">电路板</strong>。</p></li>
<li><p class="Para" id="Par73">点击<strong class="EmphasisTypeBold "> +创建新板</strong>。</p></li>
<li>在<strong class="EmphasisTypeBold ">新建新板</strong>窗口中，在<strong class="EmphasisTypeBold ">信息</strong>页签中，提供以下配置详情(<strong class="EmphasisTypeBold ">图</strong> <a href="#Fig16"> <strong class="EmphasisTypeBold "> 9-16 </strong> </a>)。然后点击<strong class="EmphasisTypeBold ">下一个</strong>按钮。<ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par75"><strong class="EmphasisTypeBold ">板名</strong> : <em class="EmphasisTypeItalic ">天气</em></p></li>
<li><strong class="EmphasisTypeBold ">Description</strong>: <em class="EmphasisTypeItalic ">Displays sensor data from various weather sensors.</em> 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig16_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig16_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-16</p><p class="SimplePara">创建新仪表板:信息选项卡</p>


</li>
</ul>

</li>
<li><p class="Para" id="Par77">在<strong class="EmphasisTypeBold ">成员</strong>选项卡中不提供任何信息。点击<strong class="EmphasisTypeBold ">提交</strong>即可。</p></li>
<li><p class="Para" id="Par78">将创建<strong class="EmphasisTypeBold ">板</strong>并加载<strong class="EmphasisTypeBold ">你的板</strong>页面(<strong class="EmphasisTypeBold ">图</strong> <a href="#Fig17"> <strong class="EmphasisTypeBold "> 9-17 </strong> </a>)。</p></li>
</ul>

<p>我们现在有了一个空的插针板，可以在上面添加卡；我们将添加一个折线图卡来显示收到的天气数据。该折线图将显示温度和相对湿度数据(不是压力——这使图表混乱，因为用于压力的刻度是如此不同)。你会看到有一系列不同的卡，你可以添加到董事会。</p>
<ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par80">点击<strong class="EmphasisTypeBold ">天气</strong>板。</p></li>
<li><p class="Para" id="Par81">点击<strong class="EmphasisTypeBold "> +添加新卡</strong>。</p></li>
<li>In the <strong class="EmphasisTypeBold ">Create card</strong> window, click the <strong class="EmphasisTypeBold ">Line chart</strong>


 (<strong class="EmphasisTypeBold ">Figure</strong> <a href="#Fig18"><strong class="EmphasisTypeBold ">9-18</strong></a>). 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig18_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig18_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-18</p><p class="SimplePara">选择折线图数据可视化选项</p>


</li>
<li>In the <strong class="EmphasisTypeBold ">Create Line chart Card</strong> window, in the <strong class="EmphasisTypeBold ">Card source data</strong> tab, select the <strong class="EmphasisTypeBold ">device</strong> you created earlier and click <strong class="EmphasisTypeBold ">Next</strong> (<strong class="EmphasisTypeBold ">Figure</strong> <a href="#Fig19"><strong class="EmphasisTypeBold ">9-19</strong></a>). 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig19_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig19_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-19</p><p class="SimplePara">选择设备</p>


</li>
<li><p class="Para" id="Par84">点击选择<strong class="EmphasisTypeBold "> xb123456 </strong>设备(rem——这是我们在<strong class="EmphasisTypeBold ">第 9-6 节</strong>中指定的<strong class="EmphasisTypeBold ">设备 ID </strong>，然后点击<strong class="EmphasisTypeBold ">下一步</strong>。</p></li>
</ul>

<p>在这一步中，我们已经将 micro:bit edge 设备链接到折线图。我们现在需要告诉折线图使用哪些数据以及如何处理它。我们将添加两个数据集(温度和湿度)；我们需要用<strong class="EmphasisTypeBold ">表</strong> <a href="#Tab2"> <strong class="EmphasisTypeBold "> 9-2 </strong> </a>中的细节添加这些<strong class="EmphasisTypeBold ">新数据集</strong>。</p>
<p>表 9-2</p><p class="SimplePara">用于设置折线图卡的参数</p>


<table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="tcol1 align-left"/>
<col class="tcol2 align-left"/>
<col class="tcol3 align-left"/>
</colgroup>
<thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">您需要输入的数据点的名称</p>
</th>
<th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">要输入的温度值</p>
</th>
<th style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">要输入的湿度值</p>
</th>
</tr>
</thead>
<tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara"><strong class="EmphasisTypeBold ">事件</strong></p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">状态 1</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">状态 2</p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara"><strong class="EmphasisTypeBold ">属性</strong></p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">温度</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">湿度</p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara"><strong class="EmphasisTypeBold ">名称</strong></p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">温度</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">湿度</p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara"><strong class="EmphasisTypeBold ">类型</strong></p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">数字</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">数字</p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara"><strong class="EmphasisTypeBold ">单位</strong></p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">C</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">%</p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara"><strong class="EmphasisTypeBold ">分钟</strong></p>
</td>
<td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">-40</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Zero</p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara"><strong class="EmphasisTypeBold ">最大</strong></p>
</td>
<td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">eighty-five</p>
</td>
<td style="text-align: left;"><p class="SimplePara">One hundred</p>
</td>
</tr>
</tbody>
</table>

<p>
 
</p>
<ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par87">在<strong class="EmphasisTypeBold ">卡片预览</strong>页签中，点击<strong class="EmphasisTypeBold "> XL </strong>。然后点击<strong class="EmphasisTypeBold ">下一步</strong>。</p></li>
<li>在<strong class="EmphasisTypeBold ">卡片信息</strong>页签中，提供以下详细信息，点击<strong class="EmphasisTypeBold ">提交</strong>。<ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par89"><strong class="EmphasisTypeBold ">标题</strong> : <em class="EmphasisTypeItalic ">实时和历史天气数据</em></p></li>
<li><p class="Para" id="Par90"><strong class="EmphasisTypeBold ">配色</strong>:选择任意颜色</p></li>
</ul>

</li>
</ul>

<p class="Para" id="Par91">卡已经添加到电路板上，电路板现在可以使用了:一旦我们设置了数据馈送，我们应该可以看到折线图随着温度和湿度数据实时更新。</p>
<p class="Para" id="Par92">其他卡片也可以用同样的方法添加到棋盘上。为什么不添加一张卡片来显示压力数据呢？</p>

<h2 class="Heading">9.8 为我们的 Wi-Fi 气象站编码</h2>
<p>在本节中，我们将编写使 micro:bit 像数字气象站一样工作所需的代码；我们首先设置物联网平台，因为我们需要在代码中包含它的细节。<strong class="EmphasisTypeBold ">图</strong> <a href="#Fig20"> <strong class="EmphasisTypeBold ">图 9-20 </strong> </a>用自然语言勾勒出程序流程。</p>
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig20_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig20_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-20</p><p class="SimplePara">我们物联网气象站的自然语言代码</p>


<p><strong class="EmphasisTypeBold ">图</strong> <a href="#Fig20"> <strong class="EmphasisTypeBold "> 9-20 </strong> </a>包括两个我们之前没有遇到过的步骤:</p>
<ul class="UnorderedListMarkNone"><li><p class="Para" id="Par95"><strong class="EmphasisTypeBold ">第二步</strong>:连接 Wi-Fi 网络。要连接到 Wi-Fi 网络，你需要知道它的名字(<strong class="EmphasisTypeBold "> SSID </strong>和<strong class="EmphasisTypeBold ">密码</strong>)。在你开始写代码之前，准备好这些。</p></li>
<li><p class="Para" id="Par96"><strong class="EmphasisTypeBold ">第三步</strong>:连接物联网平台。这在<strong class="EmphasisTypeBold ">表</strong> <a href="#Tab3"> <strong class="EmphasisTypeBold "> 9-3 </strong> </a>中有解释。</p></li>
</ul>

<p>您需要在代码中输入物联网平台的许多细节。<strong class="EmphasisTypeBold ">表</strong> <a href="#Tab3"> <strong class="EmphasisTypeBold "> 9-3 </strong> </a>解释了如何找到并构建 MakeCode 中使用的每个参数。</p>
<p>表 9-3</p><p class="SimplePara">设置生成代码块的参数</p>


<table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="tcol1 align-left"/>
<col class="tcol2 align-center"/>
</colgroup>
<thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">要在生成代码中设置的参数</p>
</th>
<th style="border-bottom: 0.5pt solid ; text-align: center;"><p class="SimplePara">在哪里找到/如何创建参数</p>
</th>
</tr>
</thead>
<tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">要连接物联网平台，需要设置<strong class="EmphasisTypeBold ">客户端 ID </strong>值。</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: center;"><p class="SimplePara"><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Figa_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Figa_HTML.jpg" style="width:10em"/></p>
<p class="SimplePara">客户端 ID 由 3 个参数组成，您需要以一种非常特殊的格式将它们连接在一起("<strong class="EmphasisTypeBold "> concatenate </strong>")。您需要的参数是</p>
<p class="SimplePara">组织 ID</p>
<p class="SimplePara">设备类型</p>
<p class="SimplePara">设备 ID</p>
<p class="SimplePara">格式是</p>
<p class="SimplePara"><em> <strong class="EmphasisTypeBoldItalic "> d:组织标识:设备类型:设备标识</strong>T3】</em></p>
<p class="SimplePara">当您正确地连接数据后，它应该看起来像这样:</p>
<p class="SimplePara"><strong class="EmphasisTypeBold "> d：奥普拉 53：中国包装：xb123456 </strong></p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">要连接到物联网平台，需要在<strong class="EmphasisTypeBold ">Connect to MQTT broker</strong>块中设置 3 个值。</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: center;"><p class="SimplePara"><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Figb_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Figb_HTML.jpg" style="width:30em"/></p>
<p class="SimplePara">为此，您需要在连接到 MQTT broker 块的<strong class="EmphasisTypeBold ">中输入 3 个参数:</strong></p>
<p class="SimplePara">1.<strong class="EmphasisTypeBold ">代理 URL </strong>(或“连接地址”)</p>
<p class="SimplePara"><em class="EmphasisTypeItalic ">在字符串“. messaging . internetofthings . IBM cloud . com”</em>的前面加上 <em> <strong class="EmphasisTypeBoldItalic ">组织 ID </strong> </em> <em class="EmphasisTypeItalic "/></p>
<p class="SimplePara"><em class="EmphasisTypeItalic ">一个正确的</em> <em> <strong class="EmphasisTypeBoldItalic ">经纪人网址</strong> </em> <em class="EmphasisTypeItalic ">看起来是这样的:</em></p>
<p class="SimplePara">奥普拉 53。messaging.internetofthings.ibmcloud.com</p>
<p class="SimplePara">2.<strong class="EmphasisTypeBold ">用户名</strong></p>
<p class="SimplePara"><em class="EmphasisTypeItalic ">此处输入固定字符串“use-token-auth”。</em></p>
<p class="SimplePara">3.<strong class="EmphasisTypeBold ">密码</strong></p>
<p class="SimplePara"><em class="EmphasisTypeItalic ">密码是</em> <em> <strong class="EmphasisTypeBoldItalic ">设备凭证</strong> </em> <em class="EmphasisTypeItalic ">部分中指定的</em> <em> <strong class="EmphasisTypeBoldItalic ">认证令牌</strong> </em> <em class="EmphasisTypeItalic ">。</em></p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">要向物联网平台传递数据，你需要向特定的<strong class="EmphasisTypeBold ">主题发送一个<strong class="EmphasisTypeBold ">有效载荷</strong>。</strong></p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: center;"><p class="SimplePara"><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Figc_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Figc_HTML.jpg" style="width:12.56em"/></p>
<p class="SimplePara">我们发送到物联网平台的内容被称为<strong class="EmphasisTypeBold ">有效载荷</strong>，我们必须指定我们要将它发送到哪里:T2 主题。</p>
<p class="SimplePara">1.<strong class="EmphasisTypeBold ">有效载荷</strong></p>
<p class="SimplePara">我们必须连接 3 位来构建有效载荷。选择一个连接块并添加以下元素:</p>
<p class="SimplePara">{" <em class="EmphasisTypeItalic ">【变量名】</em>":"</p>
<p class="SimplePara">您想要发送的值</p>
<p class="SimplePara">• "}</p>
<p class="SimplePara">因此，如果您正在发送温度数据，连接块将如下所示:</p>
<p class="SimplePara"><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Figd_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Figd_HTML.jpg" style="width:29.94em"/></p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; text-align: left;"> </td>
<td style="text-align: center;"><p class="SimplePara">2.<strong class="EmphasisTypeBold ">话题</strong></p>
<p class="SimplePara">主题是一个字符串，它告诉物联网平台将数据传递到哪个卡，以及它是哪个数据点。题目的格式为<em> <strong class="EmphasisTypeBoldItalic "> iot-2/evt/ &lt;事件&gt;/fmt/JSON</strong>T3】。</em></p>
<p class="SimplePara">一个有效的主题应该是这样的:</p>
<p class="SimplePara"><strong class="EmphasisTypeBold ">IOT-2/evt/status 1/fmt/JSON</strong></p>
<p class="SimplePara"><strong class="EmphasisTypeBold "> &lt;事件&gt; </strong>是您建卡时输入的事件名称，在<strong class="EmphasisTypeBold ">编辑折线图卡&gt;连接数据集:</strong></p>
<p class="SimplePara"><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fige_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fige_HTML.jpg" style="width:17.5em"/></p>
</td>
</tr>
</tbody>
</table>

<p><strong class="EmphasisTypeBold ">表</strong> <a href="#Tab4"> <strong class="EmphasisTypeBold "> 9-4 </strong> </a>显示了如何使用<strong class="EmphasisTypeBold ">表</strong> <a href="#Tab3"> <strong class="EmphasisTypeBold "> 9-3 </strong> </a>中列出的参数将<strong class="EmphasisTypeBold ">图</strong> <a href="#Fig20"> <strong class="EmphasisTypeBold "> 9-20 </strong> </a>中的代码转换成 MakeCode 块。</p>
<p>表 9-4</p><p class="SimplePara">使用 make 代码块开发代码</p>


<table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="tcol1 align-left"/>
<col class="tcol2 align-left"/>
</colgroup>
<thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">步骤</p>
</th>
<th style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">描述</p>
</th>
</tr>
</thead>
<tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">one</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">开始一个新项目。添加 XinaBox <strong class="EmphasisTypeBold "> SW01 </strong>和<strong class="EmphasisTypeBold "> CW01 </strong>扩展。</p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Two</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">将<strong class="EmphasisTypeBold "> CW01 连接到 WiFi </strong>模块添加到启动模块的<strong class="EmphasisTypeBold ">中。</strong></p>
<p class="SimplePara"><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Figf_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Figf_HTML.jpg" style="width:32.5em"/></p>
<p class="SimplePara">这会将您的 CW01 连接到 Wi-Fi 网络。</p>
</td>
</tr>
<tr><td rowspan="2" style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">three</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: center;"><p class="SimplePara"><strong class="EmphasisTypeBold ">连接物联网平台/设置客户端 ID: </strong></p>
<p class="SimplePara">将<strong class="EmphasisTypeBold "> CW01 set MQTT client ID </strong>模块添加到 start 模块的<strong class="EmphasisTypeBold ">中:</strong></p>
<p class="SimplePara"><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Figg_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Figg_HTML.jpg" style="width:22.44em"/></p>
</td>
</tr>
<tr><td style="border-bottom: 0.5pt solid ; text-align: center;"><p class="SimplePara"><strong class="EmphasisTypeBold ">连接物联网平台/设置 MQTT 代理:</strong></p>
<p class="SimplePara">在<strong class="EmphasisTypeBold ">设置 MQTT 客户端</strong>程序块之后，将以下程序块添加到<strong class="EmphasisTypeBold ">启动</strong>程序块中:</p>
<p class="SimplePara"><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Figh_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Figh_HTML.jpg" style="width:30em"/></p>
<p class="SimplePara">这将把气象站连接到 MQTT 代理。</p>
<p class="SimplePara"><strong class="EmphasisTypeBold ">详见表</strong> <a href="#Tab3"> <strong class="EmphasisTypeBold "> 9-3 </strong> </a> <strong class="EmphasisTypeBold ">。</strong></p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">four</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">使用<strong class="EmphasisTypeBold ">永久</strong>块。</p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">five</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: center;"><p class="SimplePara">将<strong class="EmphasisTypeBold "> CW01 发送有效载荷</strong>块添加到<strong class="EmphasisTypeBold ">永久</strong>块中；</p>
<p class="SimplePara"><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Figi_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Figi_HTML.jpg" style="width:30em"/></p>
<p class="SimplePara"><strong class="EmphasisTypeBold ">详见表</strong> <a href="#Tab3"> <strong class="EmphasisTypeBold "> 9-3 </strong> </a> <strong class="EmphasisTypeBold ">。</strong></p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">six</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: center;"><p class="SimplePara">修改步骤 6 中所示的连接块，以发送湿度数据:</p>
<p class="SimplePara"><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Figj_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Figj_HTML.jpg" style="width:27.56em"/></p>
<p class="SimplePara">CW01 发送有效载荷块的其余部分保持不变。</p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">seven</p>
</td>
<td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">我们还没有建立我们的物联网平台来处理压力数据，所以我们没有地方发送它。</p>
<p class="SimplePara">如果您已经设置了一个卡来显示压力数据，您应该尝试修改步骤 6 中的代码并将其添加到此处。</p>
</td>
</tr>
<tr><td style="border-right: 0.5pt solid ; text-align: left;"> </td>
<td style="text-align: center;"><p class="SimplePara">用暂停来完成程序，以控制数据传输的速率:</p>
<p class="SimplePara"><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Figk_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Figk_HTML.jpg" style="width:12.5em"/></p>
</td>
</tr>
</tbody>
</table>

<p><strong class="EmphasisTypeBold ">图</strong> <a href="#Fig21"> <strong class="EmphasisTypeBold "> 9-21 </strong> </a>显示了完整的<strong class="EmphasisTypeBold "> MakeCode </strong>程序块。</p>
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig21_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig21_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-21</p><p class="SimplePara">为 Wi-Fi 气象站制作代码块</p>


<p class="Para" id="Par100">完整的代码可以在我们的资源网站上找到。您将需要调整参数以与您的物联网平台配合工作，如<strong class="EmphasisTypeBold ">表</strong> <a href="#Tab3"> <strong class="EmphasisTypeBold "> 9-3 </strong> </a>中所述。</p>

<h2 class="Heading">9.9 气象站的供电和运行</h2>
<p>编译代码并将其闪存到您的 micro:bit 上。完成闪烁后，从 micro:bit 上拔下 USB 电缆。我们需要以特定的方式给气象站加电，如下所述:</p>
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig24_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig24_HTML.jpg" style="width:20em"/></p>
<p>图 9-24</p><p class="SimplePara">气象站正在向 IBM Watson 物联网平台发送数据</p>


<ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par102">将 IM01、SW01 和 CW01 连接在一起。暂时不要连接 micro:bit。</p></li>
<li>Connect a USB power cable to the IM01 (<strong class="EmphasisTypeBold ">Figure</strong> <a href="#Fig22"><strong class="EmphasisTypeBold ">9-22</strong></a>). Wait until there is a strong blue light showing on the CW01. It should take a few seconds at most. 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig22_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig22_HTML.jpg" style="width:25em"/></p>
<p>图 9-22</p><p class="SimplePara">供电过程的第二步</p>


</li>
<li>Now you can connect your micro:bit to the IM01 (<strong class="EmphasisTypeBold ">Figure</strong> <a href="#Fig23"><strong class="EmphasisTypeBold ">9-23</strong></a>). On start the micro:bit should display the pattern shown. This indicates that the CW01 is trying to connect to the Wi-Fi network. 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig23_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig23_HTML.jpg" style="width:20em"/></p>
<p>图 9-23</p><p class="SimplePara">供电过程的第 3 步</p>


</li>
<li><p class="Para" id="Par105">一旦连接到 Wi-Fi 网络，字母 C 就会显示在 5X5 LED 矩阵上。</p></li>
<li><p class="Para" id="Par106">接下来气象站将尝试连接到 IBM Watson 物联网平台。LED 矩阵上的菱形图案表示气象站和 IBM Watson 物联网云之间的活动连接。</p></li>
</ul>

<p class="Para" id="Par107">只要 micro:bit 通电且菱形图案显示，数据就会发送到物联网天气服务。下一节解释如何查看数据。</p>

<h2 class="Heading">9.10 查看数据可视化</h2>
<p>随着一切顺利运行，micro:bit 气象站应该会将数据传输到物联网平台。通过查看您在插接板上设置的可视化来确认这一点:</p>
<ul class="UnorderedListMarkBullet"><li>Click <strong class="EmphasisTypeBold ">Boards</strong> in the left navigation and then click the <strong class="EmphasisTypeBold ">Weather</strong> board created in <strong class="EmphasisTypeBold ">Section 9.7</strong> (<strong class="EmphasisTypeBold ">Figure</strong> <a href="#Fig25"><strong class="EmphasisTypeBold ">9-25</strong></a>). 
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig25_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig25_HTML.jpg" style="width:15em"/></p>
<p>图 9-25</p><p class="SimplePara">访问折线图以查看来自气象站的数据</p>


</li>
<li><p class="Para" id="Par110">折线图将显示您指定时间段内的温度和湿度数据(<strong class="EmphasisTypeBold ">图</strong> <a href="#Fig26"> <strong class="EmphasisTypeBold "> 9-26 </strong> </a>)。</p></li>
</ul>

Note
<p class="Para FirstParaInFormalPara" id="Par111">还可以选择发布公告板并公开发布。在<strong class="EmphasisTypeBold ">版块设置的<strong class="EmphasisTypeBold ">成员</strong>标签下，</strong>有一个选项<strong class="EmphasisTypeBold ">只读分享给所有人</strong>。选中此框将通过您可以共享的 URL 提供对公告板的公共访问。</p>

<p> 
</p>
<p><img alt="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig26_HTML.jpg" src="../images/486852_1_En_9_Chapter/486852_1_En_9_Fig26_HTML.jpg" style="width:35.62em"/></p>
<p>图 9-26</p><p class="SimplePara">我们板上显示实时和历史天气数据的折线图卡</p>



<h2 class="Heading">9.11 摘要</h2>
<p class="Para" id="Par112">如果一切按计划进行，您的气象站将连接到物联网平台，您可以使用网络浏览器在板上查看实时数据。冒着显而易见的风险，你可以在世界上任何一个地方(可以连接互联网的地方)查看公告板。如果这看起来很平凡，请记住，20 年前这是非常困难的，甚至 10 年前，也许 5 年前，你需要一个广泛的专业技能来建立这样的东西。</p>
<p class="Para" id="Par113">所以花一点时间来感受一种成就感:你在这一章中所做的并不是微不足道的，只有极小一部分人类曾经成功地做到了这一点。更重要的是，我们建立的模型是一个我们将任何传感器数据发送到云服务的模型。切换不同的传感器相对来说比较简单，这大大扩展了该系统的潜力。此外，我们使用了一个提供丰富的可视化工具集的服务，但是连接到其他类型的服务，甚至可能是人工智能服务呢？这正是我们在<strong class="EmphasisTypeBold ">章</strong> <a href="11.html"> <strong class="EmphasisTypeBold "> 11 </strong> </a>和<strong class="EmphasisTypeBold ">章</strong> <a href="12.html"> <strong class="EmphasisTypeBold "> 12 </strong> </a>中要做的。</p>
<p class="Para" id="Par114">但是在我们渴望使用人工智能之前，我们需要对它有一点了解，我们将在第<strong class="EmphasisTypeBold ">章</strong> <a href="10.html"> <strong class="EmphasisTypeBold ">第 10 章</strong> </a>中看到。</p>

<aside aria-label="Footnotes" class="FootnoteSection" epub:type="footnotes">Footnotes
<a href="#Fn1_source">1</a><p class="Para" id="Par4">大多数人认为缩写词<strong class="EmphasisTypeBold "> Wi-Fi </strong>来源于短语“无线保真”。事实上，Wi-Fi 是 IEEE 802.11x(T3)的商标术语，IEEE 802.11 x 是无线通信的标准(当然，蓝牙也是)。它与蓝牙的不同之处在于它最适合的用途。蓝牙用于在较短的范围内将两个设备安全地连接在一起(例如，将耳机连接到移动电话)。Wi-Fi 覆盖范围更广，速度更快，功耗更低，旨在为互联网提供通信网络。</p>
<p class="Para" id="Par5">就我们的目的而言，我们可以将 Wi-Fi 理解为智能设备与互联网无线共享数据的方式。</p>

 

<a href="#Fn2_source">2</a><p class="Para" id="Par25">MQTT(消息队列遥测传输)是一种无线通信标准。它不是 Wi-Fi(或蓝牙)的竞争对手:它是一个适用于使用 Wi-Fi 发送信息的标准。对于我们的需求来说，知道大多数物联网平台将符合 MQTT 就足够了。如果您知道如何连接到一个 MQTT 物联网平台，那么您应该能够连接到其他平台。</p>

 

</aside>


</body>
</html>