

# 一、了解 AI/ML 的前景

在这一开篇，我们会给你一点欣赏和背景的*为什么*背后的人工智能和**机器学习** ( **ML** )。我们仅有的数据来自过去，利用这些数据可以帮助我们预测未来。我们将看看今天进入这个世界的大量数据，并尝试了解我们必须处理的数据的规模。

任何类型的软件或算法的主要目标都是解决商业和现实世界的问题，所以我们也将看看应用程序是如何形成的。如果我们用食物做类比，数据就是配料，算法就是厨师，做出的饭菜就是模型。您将了解更广泛的领域中最常用的模型类型，以及如何知道使用什么。

作为一名数据科学家，您可以使用大量的工具，因此我们还将讨论如何使用 Anaconda 提供的解决方案来完成您想要的实际工作，并在您的模型变得陈旧时采取行动(它们会变得陈旧)。在本章结束时，你会对人工智能的价值和前景有所了解，并且能够快速启动任何你想要建立的项目。

人工智能是我们这个时代最令人兴奋的技术，在整个第一章中，这些主题将为你提供坚实的基础，我们将在本书的其余部分中建立这些基础。这些都是你日常生活中常见的关键概念，你会发现它们在完成你需要做的事情时是无价的。

在本章中，我们将讨论以下主要话题:

*   了解人工智能和人工智能的现状
*   了解新数据的大规模生成
*   如何用 AI 创造商业价值
*   了解 ML 模型的主要类型
*   处理过时的模型
*   使用 Anaconda 安装软件包

# 引入人工智能(AI)

人工智能发展很快。现在这已经变得如此平常，以至于人们期望系统是智能的。例如，就在不久前，在国际象棋中与人类思维竞争的技术是一项开创性的人工智能，令人惊叹。现在我们甚至不再想它了。每秒数百万次战术和战略计算现在只是一个简单的游戏，可以在任何计算机上找到或在数百个网站上玩。

那似乎是智慧…那是人工的。简单吧？有了垃圾邮件拦截器、推荐引擎和最佳递送路线，目标不断变化，以至于现在，所有曾经被认为是人工智能的东西现在都被简单地视为日常工具。

曾经被认为是人工智能的东西现在仅仅被认为是简单的软件。似乎 *AI* 只是表示还没有解决的问题。随着这些成为正常的日常操作，它们可以从我们通常认为的人工智能中淡出。这就是众所周知的拉里·特斯勒定理，陈述*“人工智能是任何还没有被做的东西。”*

例如，如果你问某人什么是 *AI* ，他们可能会谈论自动驾驶、无人机送货和可以执行非常复杂动作的机器人。所有这些例子在很大程度上都属于未解决的问题，随着(或者如果)它们得到解决，它们可能不再被认为是人工智能，因为更新、更困难的问题取而代之。

在我们进一步深入之前，让我们确保我们在几个术语上是一致的，这将是本书其余部分的重点。

## 定义人工智能

重要的是要指出这样一个事实，即人工智能是什么并没有一个通用的标签，但出于本书的目的，我们将使用以下定义:

“人工智能(AI)是计算机系统的发展，允许它们执行模仿人类智能的任务。这可以使用视觉、文本、阅读理解、复杂问题解决、标签或其他形式的输入。”

## 定义数据科学家

除了人工智能的定义,定义什么是数据科学家也可以让你有很多不同的描述。要知道和 AI 一样，数据科学领域可以是一个非常宽泛的范畴。乔希·威尔斯在推特上写道，数据科学家如下:

“一个比任何软件工程师都更擅长统计，比任何统计学家都更擅长软件工程的人。”

虽然这可能有些道理，但我们将使用以下定义来代替:

“数据科学家是通过分析、应用统计数据和实施人工智能方法从数据中获得洞察力和知识的人，以便能够回答问题和解决问题。”

如果你正在读这篇文章，那么你可能属于这一类。数据科学家需要能够利用许多工具来实现最终目标，我们将在本书中了解其中的许多工具。

现在我们已经对人工智能有了一个基本的了解，让我们来看看人工智能的现状，并了解一下 ML 在这幅图中的位置。

# 了解人工智能和人工智能的现状

过去是我们收集数据来预测未来的唯一地方。这是 AI 和 ML 的核心价值主张之一，对于领域本身也是如此。我不想给你们上太多的历史课，但是要知道今天使用的技术和方法并不新鲜。事实上，神经网络已经存在了 60 多年了！了解了这一点，在您的数据科学之旅中请记住，您认为*陈旧或过时的白皮书或方法*可能还没有达到技术或数据赶上它的正确点。

这些系统允许比我们让人类执行同样的任务更大的可扩展性、分布性和速度。我们将在本章的后面深入探讨具体的问题类型。

目前，创造人工智能最知名的方法之一是神经网络，其中数据科学家从人类大脑的工作方式中获得灵感。当两件事情发生时，神经网络才是真正可行的途径:

*   我们在 2012 年建立了联系，就像我们的大脑一样，如果我们创建多个层次，我们可以获得更好的结果。
*   GPU 变得足够快，能够在合理的时间框架内训练模型。

如果我们没有用新的眼光和更新的硬件回到过去的想法，人工智能技术的这一巨大飞跃是不可能的。

在使用更先进的 GPU 之前，训练一个模型需要太长时间，所以这不切实际。想象一下一条装配线生产一辆汽车。如果每天移动一米，这将是一个有效的最终结果，但生产一辆汽车将需要非常长的时间(亨利·福特 1914 年的装配线以每分钟两米的速度移动)。类似于 4k(和 8k)电视在流媒体或蓝光格式允许我们拥有甚至可以在 4k 中显示的内容之前特别无用，有时，在应用程序可以完全实现之前，其他支持技术需要改进。

过去十年中计算能力的巨大增长释放了张量计算真正发光的能力，并使我们远离了关于感知机的康奈尔报告，这是第一篇提到将成为我们今天使用的神经网络的想法的论文。GPU 能力的增长速度使得大量的训练可以在几个小时内完成，而不是几年。

张量本身在物理学和其他形式的工程中很常见，是数据科学如何受到其他领域的重大影响以及与数学有着特别密切关系的一个例子。现在，它们是使用神经网络训练深度学习模型的主要工具。

张量

张量只是神经网络中常用的一种数据结构，但它是一个数学术语。它可以指矩阵、向量和任何 n 维数组，但在涉及神经网络时，主要用于描述后者。这也是广受欢迎的谷歌图书馆 TensorFlow 得名的原因。

深度学习是 AI 领域的技术，更具体地说是 ML 领域的技术，但它们不是一回事吗？答案是*没有*。理解这种差异将有助于你专注于特定的子集，并确保你对外面的情况有一个清晰的了解。接下来让我们更深入地了解一下。

## 了解人工智能和人工智能的区别

**机器学习(ML)** 简单来说就是机器能够根据输入数据推断事物，而不需要被明确告知事物是什么。它学习和推断模式，并尽最大努力将新数据融入该模式。事实上，ML 是更大的人工智能领域的一个子集，因为这两个术语都被广泛使用，所以获得一些不同类型的人工智能的简短示例以及这些子集如何适应更广泛的术语是有价值的。

让我们看一个简单的维恩图，它显示了 AI，ML 和深度学习之间的关系。你会看到 *AI* 是更广泛的概念，ML 和深度学习是特定的子集:

![Figure 1.1 – Hierarchy of AI, ML, and deep learning
](img/B16589_01_01.jpg)

图 1.1–人工智能、人工智能和深度学习的层次结构

一个不是人工智能的例子是专家系统。这是一个基于规则的系统，是为非常特殊的情况设计的，在某些方面可以归结为 *if-else 语句*。它在幕后跟随一个手动编码系统，但那可能非常强大。例如，如果北/南向车道上的汽车数量多于 *x* 辆，但少于东/西向车道上的 *y* 辆，交通灯就会切换为绿色。

这些专家系统已经存在很长时间了，国际象棋游戏就是一个例子。来自卡内基梅隆大学的著名的*深思*搜索了每一步大约 5 亿种可能的结果，以寻找最佳结果。这足以让最优秀的棋手陷入困境。后来它让位给了*深蓝*，它开始看起来更像是 ML，因为它使用贝叶斯结构来实现它的世界征服。

*那不是艾*！你可能会说。奇怪的是……IBM 同意你的观点，至少在 90 年代末，因为他们实际上声称*不是 AI* 。这可能是因为这个词有负面的含义。然而，这种心态在现代发生了变化。人工智能的许多早期承诺已经实现，解决了许多我们知道我们想要解决的问题，并创造了全新的领域，如聊天机器人。

AI 可以是复杂的图像检测，如自动驾驶，以及语音识别系统，如亚马逊的 Alexa，但它也可以是由相对简单的指令组成的系统。想想你基于极其简单的模式完成了多少简单的任务。我饿了，我应该吃点东西。那些衣服是红色的，那些是白色的，所以它们属于不同的箱子。很简单，对吧？事实是， *AI* 是一个庞大的术语，可以包含比它被赋予的信用更多的东西。

人工智能在过去 10 年中的成就很大程度上归功于它可以访问的大量数据。在下一节中，我们将更详细地看看它是什么样子的。

# 了解新数据的大规模生成

简单来说，数据是驱动 AI 一切事物的燃料。数据量惊人。2018 年，据计算，全球 90%的数据是在最近 2 年内创建的。当你读到这篇文章时，没有理由认为 stat 可能成立。但是谁在乎呢？如果不能使用数据，数据本身就毫无意义。

水力压裂技术是一种打开 T2 新储油区的新技术，已经打开了以前无法到达的区域。如果没有这些，那些能源储备就会无所事事。这正是 AI 对数据所做的。它让我们挖掘这些以前无用的信息，以释放其价值。

数据只是世界特定状态或特定时间事件的记录。做到这一点的能力和成本遵循了著名的摩尔定律，使得存储和检索大量数据更加便宜和快捷。只要看看这些年来硬盘驱动器的价格，从 1964 年的每 GB 350 万美元，到 2021 年的今天大约 0.02 美分。

摩尔定律

著名的英特尔首席执行官摩尔定律指出，芯片上可以容纳的晶体管数量每两年就会翻一番。这一数字被多次误报为 18 个月，但实际上这是一位英特尔员工 David House 根据功耗做出的单独预测。这也可能是一个自我实现的预言，因为这是目标，而不仅仅是偶然事件。

事实证明，这条定律适用于除计算速度之外的许多事情。许多商品(尤其是科技产品)的成本也是如此。在汽车、电视成本/分辨率和许多其他领域，你会发现类似的曲线。

如果你听说新的回收工厂建成后，你用过的可乐罐会值 10 美元，你会把它们扔进垃圾桶吗？这类似于所有公司听到的关于他们数据的情况。即使他们今天可能在使用它，他们仍然尽可能地收集和储存一切，希望有一天它能被使用。存储也很便宜，而且越来越便宜。由于这两个原因，保存这些数据被视为一个更好的举措，因为它可能比存储它的成本更有价值。

你有什么有价值的数据？考虑人力资源招聘报告、每个客户购买的确切时间或搜索中的关键词——每条数据本身可能不会给你太多的洞察力，但结合 ML 给你的发现模式的能力，这些数据可能具有难以置信的价值。即使你看不到现在能做什么，给公司的信息是*坚持下去，也许会有用武之地*。正因为如此，公司成了数据包鼠。

导致数据大幅增长的一个因素是物联网设备数量的大幅增加。**物联网**代表**物联网**，这是一个概念，每天，*普通的*设备都连接到同一个互联网，你可以从这个互联网接收电子邮件、YouTube 和脸书。电灯开关、真空吸尘器、甚至冰箱都可以连接并发送制造商收集的数据，以便改进它们的功能(希望如此)。

这些看似微不足道的数据结合起来，在 2019 年创造了 *13.6 Zettabytes* ，而且这一趋势没有放缓。到 2025 年，将有 *79.4 Zettabytes* ！你将很难找到不支持物联网的新设备，因为公司总是希望在最新产品中添加新功能。从物理角度来看，如果一个 zettabyte 中的每一个 gigabyte 是一块砖，那么中国的长城可以用 38.73 亿块砖砌 258 次。这需要处理大量的数据！

新技术甚至软件架构模式已经被开发出来处理所有这些数据。**基于事件的架构**是一种处理数据的方式，它颠覆了传统的数据库模型。它有一个*事件*流，而不是把所有东西都存储在一个数据库中，任何需要这些数据的东西都可以进入这个流并获取他们需要的东西。数据太多了，他们甚至懒得放在一个地方！

但是更多的数据并不总是答案。很多时候，更多的数据是敌人。包含大量错误标注数据的数据集可能会导致模型训练质量更差。这当然有直观的意义。试图教一个人或一台计算机一些东西，同时给他们一些无效的例子，是不会得到你想要的输出的。

让我们看一个简单的例子，向你的孩子解释什么是老虎。你指出两只带黑色条纹的橙色大猫，告诉它们*看，这就是老虎的样子*。然后你指着一只全黑色的猫，然后说*看！还有一个*，错误地告诉你的孩子，这另一种动物也是老虎。您现在已经创建了一个包含假阳性的数据集，这可能会使您的孩子很难了解真正的老虎是什么。假阳性可能是 3 值数据集的问题，而假阴性可能是他们刚刚看到的问题。

重要说明

这只是为了举例。任何只在一个数据点上训练的模型几乎肯定不会提供非常准确的最终结果。有一个被称为一次性学习的研究领域试图用一个数据点工作，但这通常是在视觉问题中发现的。

您可能还会遇到这样的问题，即输入的数据与实际生产数据不相似。训练数据尽可能接近测试数据是至关重要的，因此，如果在我们之前的训练示例中，您从 300 英尺远的地方指出一只游泳的老虎，当您的孩子在动物园中看到一只从 10 英尺远的地方走过的老虎时，他们可能会发现识别一只老虎非常具有挑战性。更多并不总是等于更好。

拥有数据对人工智能的成功至关重要，但其采用背后的真正驱动力是它能为商业世界做些什么，例如网飞推荐你会喜欢的节目，谷歌让广告商在合适的人面前开展业务，亚马逊向你展示其他产品来装满你的购物车。所有这些都允许企业以其他技术或方法无法比拟的方式进行扩展，并帮助他们继续在自己的领域占据主导地位。

# 评估人工智能如何提供商业价值

脸书(现在是 Meta)、苹果、亚马逊、网飞和谷歌有什么共同点？嗯，除了是组成流行的 **FAANG** 缩写的公司之外，他们还非常关注 ML。每个人都依赖于这种技术，不仅仅是在某些领域获得小比例的收益，但很多时候，这种技术是他们工作的核心。作为一个关键点，他们将人工智能和人工智能放在核心位置的唯一原因是因为它创造的价值。当你寻求应用人工智能时，始终专注于提供商业价值和解决问题。

谷歌的增长很大程度上要归功于其非常成功的广告算法。响应式搜索广告(或 **RSA** )有一个简单的目标，即尝试优化广告，以达到最佳效果。RSA 通过利用其拥有的杠杆(如标题和正文)来获得最佳结果，即点击量。它的竞价算法总是有一个基于大量因素的特定关键词的动态定价模型，这些因素包括位置、性别、年龄组、搜索概况等。Alphabet(谷歌母公司)2020 年的营收为*1825 亿美元*，a *b* 。除了软件和 ML，没有其他方法可以用这么少的人创造这么多的现金。

其中一些小的调整是改变一分钱的价格，将用户年龄组移动到一年的目标，并根据网页的上下文改变显示的实际广告。然后，谷歌的算法会衡量它是否成功。你能想象如果一个开发人员在做了这么小的改变后，还得对定价模型的每个单独的改变进行编码吗？即使他们这样做了，实际进行的调整实际上影响预期最终值的可能性也很小。

我们可以考虑另一个例子，系统如何通过查看网飞来确定我们可能喜欢的节目。网飞能够通过使用推荐系统来建议我们接下来可能想要观看的节目，该推荐系统使用你过去的观看历史来预测未来的观看习惯。推荐系统就是以不同的准确度预测你喜欢某个内容的可能性。每当我们打开亚马逊主页，收到网飞发来的电子邮件，说有一个我们可能喜欢的新节目，或者在 Twitter 上浏览 doomscroll 时，我们都会用到这种技巧。

这些都有巨大的商业价值，因为在屏幕上获得更多的眼球有助于销售更多的广告和产品，提高点击率(实际点击广告的人数)，并增加其他指标，最终使该平台比你简单地获得 10 大最畅销商品的列表更有价值。你有自己的私人机器人在幕后试图帮助你。感觉很好，不是吗？

网飞通过为每部电影和电视剧创造潜在的特色来做到这一点，而不必像过去那样问用户一些问题，比如:*你有多喜欢喜剧？动作片？体育电影？*想想有多少人没有填写这些表格，因此网飞没有填写表格的人的保留率。

这个预测系统如此有价值，以至于网飞为任何能改进它 10%的人提供了 100 万美元的奖金。这告诉我们两件事:

*   改进人工智能系统有巨大的商业价值
*   网飞急需解决这个问题的人才

潜在特征是从其他属性的加权组合中生成的合成标签。你有没有向朋友描述过一部电影是史诗般的？那是我们的头脑把一部电影的属性放在一起，这些属性的总和创造了《T2》史诗的标签。这允许更多的自由和本质上无限的方式来组合已经存在的东西，以创建一个可以(以令人难以置信的准确性)确定某人喜欢和购买什么的系统。这也允许考虑数量减少的特征。

亚马逊已经在此基础上做出了现实举措，在人们购物之前将商品运送到当地配送中心，以提高送货速度。这提供了另一个竞争优势，提高了他们捕获和保留客户的能力。也许明天你会有一架无人机在你的房子外面等几分钟，等着你点击你已经盯了一周的新手机上的*立即购买*。

这里的每一个例子不仅要向你展示人工智能如何大规模解决问题，还要展示人工智能和 ML 不仅仅是技术领域。如果你真的想有所作为，你需要确保把你试图解决的商业问题放在你头脑的最前沿。

这些只是您可能想要解决的众多业务问题中的一部分，但是当您第一次看到这些问题时，您会从什么技术开始呢？在下一部分，我们将深入探讨这个问题。

# 了解 ML 模型的主要类型

在这里，我们将看看可以用来解决你的问题的大量技术和方法中的一些。类似于黑客可能知道他们领域的一些技术(与好莱坞让你相信的相反)，数据科学家可能只知道以下*中真正*的一个分支或领域。所以不要气馁。关键是能够根据您的问题知道使用什么工具。

为了更好地理解这一点，让我们以《星球大战》为例。假设你负责恩多卫星的防御。你有那些讨厌的伊渥克人之前袭击的数据。皇帝变得有点不安，所以你决定使用 ML 来试图找出发生了什么，并停止它。

ML 很宽泛，我们先从四大类开始:**监督学习**、**非监督学习**、**半监督学习**、**强化学习**。这种区别简单地归结为模型在被训练时得到多少帮助以及模型的期望结果。模型正在训练的数据集被恰当地称为**训练集**。让我们更详细地看看这些 ML 类别中的每一个。

## 监督学习

当你已经标记了你输入的训练数据时，使用监督学习。一个著名的早期例子是垃圾邮件检测。另一个是预测汽车的价格。这两个例子都是你知道正确答案的。关键是这些数据被标注了你所关心的主要特征，并且可以用来训练你的模型。

回到恩多卫星，你有以下数据。它显示天气、一天中的时间、货物是否到达、警卫人数和其他可能有用的数据，以及一个简单的攻击布尔标签:真/假:

![Figure 1.2 – Attack data from the moon of Endor
](img/B16589_01_02.jpg)

图 1.2——恩多卫星的攻击数据

这是监督学习的一个很好的用例(在这种情况下，你应该担心吗？).我们将在第七章 、*选择最佳人工智能算法*中更详细地查看这个场景。

属于监督学习类别的算法如下:

*   **逻辑回归**
*   **线性回归**
*   **支持向量机**
*   **K-最近邻**(一种基于密度的方法)
*   **神经网络**
*   **随机森林**
*   **梯度推进**

接下来，我们将讨论无监督学习。

## 无监督学习

无监督学习在你没有输入的带标签的训练数据时使用。一个常见的场景是当您有一组实体并且需要将它们分组时。使用这种方法的一些例子是基于特定客户子集的广告活动，或者可能共享共同特征的电影。

在下图中，您可以看到来自一家假设公司的不同客户，他们似乎可以自然地分为三类:

。

![Figure 1.3 – Example of classification problem with three customer groups
](img/B16589_01_03.jpg)

图 1.3–三个客户群的分类问题示例

这个图表可能代表你正在尝试建立的一个新的电影推荐引擎的一些客户，每个组应该得到一个单独的类型发送给他们，让他们享受观看的乐趣。

还有另一种相关的方法，采用相同的分组思想，但不是试图查看什么人或实体适合一个组，而是试图找到不属于一个主要组的实体。这些异常值不符合其他异常值的模式，搜索它们被称为**异常检测。**

异常检测也是无监督学习的一种形式。你不能有一个标签清单，上面列着*正常*和*不正常*的事情，因为你怎么知道？没有一种确定的方法来检查和标记所有可能看起来不一致的不同方式，因为将非常耗时，几乎不可能。这种类型的问题也被称为**离群点检测**，因为目标是检测那些与其他实体不同的实体。

在观察身份欺诈以了解某项行动或反应是否超出正常基线时，这一点至关重要。如果你曾经收到信用卡公司发来的短信或电子邮件，询问是否是你进行了购买，这就是异常检测在起作用！他们没有办法把所有可能发生的不正常的情况都编码出来，这再次显示了 ML 的威力。

回顾我们之前在恩多卫星上的场景，你知道有一些可疑的门卡进入发生了。你看了所有的数据，但不能理解它。你知道没有办法找出过去哪些登录是有效的，所以你不能标记数据，因此你确定这属于*无监督*算法的范畴。

下图显示了钥匙卡事件的数据集可能是什么样子，这可能是无监督问题的良好候选，特别是异常检测。如您所见，任何数据点上都没有标签。

![Figure 1.4 – Example of an anomaly problem with one anomaly
](img/B16589_01_04.jpg)

图 1.4–有一个异常的异常问题示例

其中一个数据点(右上角)显然具有一些特征，使其从该组的其他数据点中脱颖而出。击键需要更长的时间，并且在时间的热传感器读数要高得多。这是一个简单的表示，但是你可以看到有些东西看起来是不合适的。这就是异常现象的本质。

有了前面的例子，你认为右下角的事件应该被调查，还是看起来很正常？也许值得调查一下当时谁进入了系统。

属于无监督学习类别的算法如下:

*   **K 均值**(一种基于聚类的方法)
*   **隔离林**
*   **主成分分析** ( **PCA** )
*   **神经网络**

我们刚刚讨论了有监督的和无监督的，但是还有另一种类型是两者的混合和子集。让我们快速看一下**半监督**模型是什么样子的。

### 半监督学习

**半监督**学习是一个过程，通过这个过程，你试图从被标记和未被标记的数据中创建一个模型，以尝试拥有监督和非监督技术的优点。它试图从这两种类型的数据中学习，当你没有奢侈的东西被标记时，它是非常有用的。很多时候，您使用无监督的方法来寻找更高层次的模式，并使用有监督的步骤来精确调整这些模式所代表的内容。

在下面的例子中，你会看到你自己可能在没有意识到的情况下参与了这个过程。

你去过脸书吗，它让你在照片上给你的朋友加标签？这是一种半监督的工作方式。一个无监督的模型将人们的脸分组在一起，它认为是同一个人，然后用户将这些组标记为迈克尔，唐纳德，唐，等等。这样，你就把问题的一部分作为一个无监督的学习问题，把人们聚集成组，还有一部分作为一个有监督的问题，给这些组加标签。

由于这是监督和非监督的结合，理论上，你可以从相应组的任何算法家族中提取。

现在让我们继续我们列表中的最后一种人工智能方法。

## 强化学习

继监督、非监督和半监督之后，ML 的第四个主要类型是强化学习。**强化学习** ( **RL** )是一个被称为 agent 的系统通过与环境交互，逐渐学习通过奖励函数完成一些任务的过程。

奖励函数是一种确定期望结果的方式，强化学习模型试图优化它所做的事情以实现最高的奖励值。以迷宫中的老鼠为例。在这个例子中，老鼠是代理人，环境是迷宫，奖励函数是奶酪的气味有多强(并最终吃掉它)。

每次向右转，奶酪的味道就会变得更浓。然后，它试图找出如何导航，以使气味继续增加，直到最后它得到最大的奖励，这是一片美味的马苏里拉奶酪。强化在机器人、自动驾驶和其他任何有明确最终目标，但没有传统训练数据集作为起点的领域都是一种流行的选择。

奖励函数也可以以相反的方式工作。以一个新生儿为例。父母被设定为尽量减少他们的小女孩哭泣的次数，因此他们知道该做什么或不该做什么。你刚把她放下，她就开始哭了吗？把她抱起来。半夜开始哭？试着喂她，然后给她换尿布。对我们来说，这些听起来很简单，但这是我们所有人固有的 RL，它决定我们做什么，并优化我们成为好父母。在这种情况下，父母是观察环境并采取行动的代理人，婴儿哭的多少是奖励功能。最小化哭泣，优化微笑。突然成为父母听起来很简单。

在被谷歌收购之前， *DeepMind* 展示了 RL 如何被用来学习玩许多 Atari 游戏，事先不知道它们是如何工作的，唯一的输入是屏幕上的像素:【https://arxiv.org/abs/1312.5602】T2。

这篇文章很好地定义了 RL 是什么，以及它与其他人工智能方法的一个关键区别:[https://www . synopsys . com/AI/what-is-reinforcement-learning . html](https://www.synopsys.com/ai/what-is-reinforcement-learning.html)。

在 RL 中，通过代理与环境的直接交互来获得训练数据。训练数据是学习代理的经验，而不是必须提供给算法的单独的数据集合。这大大减轻了负责培训过程的主管的负担。

有时，训练数据被输入到 AlphaGo 等 RL 系统中，但该训练数据只是用来运行模拟，使用它知道的基于奖励函数的最佳结果。许多关于自动驾驶的研究都采用了同样的方法。

## 评估问题类型

有了所有这些不同类型的方法，简单回顾一下当你开始考虑一个问题时如何知道该走哪条路是好的。在下图中，我们将找到一个简单的流程图来确定哪种方法可能是正确的:

![Figure 1.5 – Decision tree for ML problem types
](img/B16589_01_05.jpg)

图 1.5–ML 问题类型的决策树

如您所见，您需要问自己两个关键问题，以找到最合适的方法:

1.  我有训练数据集吗？
2.  这个训练数据集有标签吗？

请注意，RL 仍然需要训练数据(所有 AI 算法都需要)，但它只是与其他算法的形状非常不同。当代理与环境交互时，R1 将获得其训练数据。你一开始就不需要生成和清理一个静态的集合。一些 RL 应用程序，如 AlphaGo，确实为模型训练提供了数据，但这些数据是创建良好模拟和获得游戏体验所需的数据形式。它不是直接从硬数据中提取数据，而是代理在过程中不断学习。

RL 与其他代理的一个关键区别是，代理可以直接影响环境的数据和状态。玩 Atari 游戏的算法、自动驾驶汽车和保龄球机都将在该算法影响的动态状态下运行。相比之下，监督学习算法永远不会改变训练中使用的数据。

随着时间的推移，你会很好地了解这些，你不需要问这些问题，就可以直接跳到正确的方法，但使用这个简单的图表作为快速入门指南是很好的。

有了这些信息，你现在知道了你在野外会遇到和解决的 ML 问题的主要类型。监督学习是当你有带标签的数据时，无监督学习是当你试图理解没有标签的数据时，半监督学习是当你使用结合两者的技术时。您还了解到，RL 是指您知道自己想要实现的结果，并且需要一个代理来找出实现这一目标的最佳方式。

所有这些模型类型都有一个共同点，那就是随着时间的推移，它们的表现可能不如最初训练它们时那么好。让我们在下一节中更详细地探索这是什么样子的。

# 处理过时的模型

因此，你已经训练了完美的模型，数据正在流入算法，并产生了很好的结果。坐下来放松一下，好吗？不完全是。就像你需要不断调整餐馆的菜单以跟上新顾客的喜好一样，你也需要更新你的模型以接受新的数据并做出相应的调整。幸运的是，您有相当多的工具可以这样做。

除了用于对人工智能模型算法进行分类的训练数据的性质之外，训练如何或何时发生也被考虑在内。让我们更详细地看一下这两种类型的培训方法:在线培训和批量培训。

## 在线学习和批量学习的区别

**在线学习**是你有一个*实时*学习过程，可以在进来时接受新数据来调整算法。想起第一次学怎么打高尔夫。一开始，你只看了一点 PGA 巡回赛，你知道你需要抓起一根球杆挥杆而去。你随便挑一个俱乐部，开始黑。经过几个沙坑和四个柏忌后，你有一个朋友给你一些指点，你意识到经过调整后，你已经设法在最后 9 洞减少了很多杆数。你已经调整了你的比赛。

确保你不只是对你正在做的事情采取一种静态的方法，可以让你调整你的方法，并把新的信息融入到你正在做的事情中。

另一种方法是批量学习。**批量学习**就是你取一大块数据，馈入训练阶段吐出一个静态模型。回到我们之前的例子，在我们寻求获得我们的巡回赛卡，这就像在打完 18 洞后，你去参加一些专业课程，然后回到球场上测试你的新方法。

这就是对 ML 的主要误解之一。人工智能模型在接受和处理来自世界的数据时，不会简单地自行改进。有很多方法可以做到这一点，许多部署的人工智能模型都使用批量学习过程。

为什么不一直使用在线学习呢？那么，找一个朋友在高尔夫球场上帮助你比花时间和专业人士交谈更好吗？各有利弊。现在让我们来看几个例子:

*   第一个原因是手头的业务场景。例如，如果你试图在一场体育赛事发生之前预测它的结果，那么使用在线学习是没有意义的。
*   另一个原因是，设置批量学习可以让你解析并更好地控制输入到模型中的确切数据。您可以创建一个数据管道，将某些规则应用于流入的数据，但是您仍然不能像处理批处理那样对数据进行同样的关注和分析。
*   下一个原因是方便。有时候，数据离你的模型推断发生的地方很远。**推断**是当你的模型通过系统实际处理实时数据时，很多时候简称为*运行*或*给模型打分*。也许你正在边缘设备上运行你的模型，比如手机或者物联网设备。在这种情况下，可能没有一种简单或有效的方法来处理大量的数据，并将其放到正确的地方进行训练。
*   就时间和金钱而言，培训也是昂贵的，这与该模型运行的位置有关。许多类型的模型需要强大的 GPU、CPU、内存或其他一些不存在的专用硬件。将您的培训与您的模型运行的地方分开，可以让您将这些阶段分开，并允许您围绕确切的用例设计专门的设备或架构。例如，也许训练你的模型需要你以每小时 5000 美元的价格租用的 GPU，但一旦你的模型被训练，它就可以在 50 美元的机器上使用。
*   不使用在线学习的最后一个原因是，您不希望部署的模型发生变化。如果你有一辆自动驾驶汽车，你真的希望新的数据被接受，导致你的每辆汽车都有稍微不同的模型吗？这将导致在野外同时运行 100，000 多个不同的模型。几乎可以保证每一个都与最初的真相来源有些许不同。从道德和安全的角度来看，这种影响是巨大的，更不用说试图回答正在发生的事情和原因了。在这种情况下，最好有一个黄金标准，你可以训练，然后测试。这样，当你推出像特斯拉这样的更新时(毫无疑问，当你读到这篇文章时，其他人也会跟进)，那个确切的模型已经在现实世界中运行过了。

另一方面，在你有能力和支持获取新数据的领域，在线学习确实有巨大的优势。预测分析就是一个例子，当你使用历史数据来预测一些事情，比如风力涡轮机什么时候会发生故障。当天气开始变化，物理系统的运行机制可能会有所不同时，能够在实时数据上进行训练可能会对您有所帮助。快进到未来几周或几个月，你可能会得到比静态模型好得多的结果。

在线学习对模型漂移有很大的帮助，我们将在下一节讨论。

## 模型如何变得陈旧:模型漂移

漂移是 ML 世界的一个主要问题。什么是漂移？**模型漂移**是指你用来训练模型的数据不能代表模型所处的世界的当前状态。在你的兄弟姐妹看完他们喜欢的所有节目后，根据你的偏好训练的网飞算法可能会关闭。一个风力涡轮机的运行在夏季需要温度和条件，但是现在冬季的暴风雪已经极大地改变了它运行的气候。

回到我们的高尔夫球例子，这就像在一个球场上变得很棒，但后来球场所有者决定把事情搞混，把所有的沙坑移动到*漂移*到你最喜欢的第 4 洞开球的地方。如果你不考虑这种新的漂移，你会发现自己在吃沙子，而不是沾沾自喜地走向你完美放置的发球台。

让我们来看看这个高尔夫的例子，看看事情是如何从一周到下一周发生变化的。在第一张图中，你可以看到你正常的高尔夫击球，而在第二张图中，你可以看到在沙坑位置改变后，下一周的同一击球:

![Figure 1.6 – Golf course showcasing the model drift of a bunker
](img/B16589_01_06.jpg)

图 1.6–展示沙坑模型漂移的高尔夫球场

正如你在第二张图中看到的，球场设计师决定将沙坑移近发球区。你可以继续像以前一样在相同的位置击球，但是改变后你会得到更糟糕的结果，因为你现在直接击球进入了这个沙坑。这是你需要对你的模型做的；确保你在关注并意识到我们生活在一个可以进化的动态世界中。

模型漂移是一个需要考虑的重要概念，有许多工具可以帮助解决这个问题，我们将在第 8 章 、*处理常见数据问题*中进一步讨论。但是现在让我们先来看看如何安装这些工具。

# 使用 Anaconda 安装软件包

现在，让我们继续学习一些更实用的知识，了解如何开始进入数据科学的旅程，并为本书的其余部分做好准备。我们将快速介绍如何下载 Anaconda 并安装您需要的软件包和软件。

简而言之:作为一名数据科学家，有很多工具可供您使用。很多。其中一些只是事实上你应该使用的，不要回头看(比如目前的 **Python** )，而一些有少量真正的竞争者(比如 **conda** 对 **pip** )，然后当你进入工具集和软件包时，由于开源运动(我们将在下一章中更详细地讨论)，它完全打开了。

Anaconda 本身是工具或项目的发行版或精选集合。你会在短语 **Linux 发行版**中听到这个术语。这意味着有人打包了一组他们认为有用的组件，并让您在一个简单的包中使用它们。想象一个礼物篮或者一束预先做好的夏季鲜花。

接下来，让我们进一步了解 Anaconda 及其主要优点。

## 如何使用 Anaconda 个人版下载软件包

Anaconda 个人版是一个工具和软件包的集合，让你在本地计算机上设置一切开始或继续你的数据科学之旅变得非常简单。这是 ML 和 AI 的简单按钮。这也被称为 Anaconda 发行版，因为它是 Anaconda 作为单个组分发的一组精选工具。这与基于 Linux 的系统使用的术语相同，是其他事物的集合。

以下是你安装 *Anaconda 个人版*时得到的主要组件:

*   Python 是数据科学中最常用的语言
*   **Conda** :一个包管理器和虚拟环境工具
*   导航器(Navigator):一个 GUI 工具，为您提供 Conda 的主要功能
*   250 多种包装

强烈建议并且有必要下载 Anaconda 来阅读这本书。它是免费的供个人使用，并带有前面的组件。包括的一些包是用于数组数学运算的 NumPy 和用于视觉运算的 Bokeh 等等。可以安装在[https://www.anaconda.com/products/individual](https://www.anaconda.com/products/individual)。

Anaconda 商业用个人版

重要的是，*个人版*就是为个人设计的。如果你想在商业环境中使用它，那么你需要检查并找到一个许可证。目前，它被称为*商业版*，这让你在你下载大量软件包的环境中使用它。由于在你读到这封信的时候，情况可能会发生变化，建议你去官方网站了解更多信息:[https://www.anaconda.com/products/commercial-edition](https://www.anaconda.com/products/commercial-edition)。

Python 将成为数据科学的首选语言，因此本书将对此进行介绍。虽然有许多其他精彩的语言，但 Python 在这个领域表现出色，因为它易于使用，能够成为许多其他工具的粘合剂，并且以包的形式提供了大量令人惊叹的数据科学库。

由于存在大量的软件包，拥有一个软件包管理器对于能够专注于手头的实际问题而不是与系统文件斗争是至关重要的。如果你想对自己狠一点，从源代码开始构建可能是花一个月时间的好方法，但是让 conda 来帮你做这个重担可能更容易。即使只有几个工具，也可能很快让您陷入这样的境地:您必须将大量文件移动到正确的位置才能找到您需要的文件。Python 自带 pip，一开始完全没问题，但有另一个解决方案比它有巨大的优势，我们现在来看一下。

Anaconda 有一个奇妙的解决依赖地狱的方法。它的主要产品 **conda** 是一个包和环境管理器，极大地减轻了必须弄清楚什么与什么相配的负担。由于依赖关系可能非常复杂，您可能会发现自己处于这样一种情况，即您只想尝试这个伟大的新库或工具，却惊恐地意识到它需要的是不同版本的包 *x* ，它与您真正的项目所依赖的东西 *y* 不兼容，现在已经坏了。这是依赖地狱。

使用 conda 通过 pip 管理软件包的最大原因是，conda 将为您解决依赖性，而您不必为了让所有的东西一起工作而挑选您需要的工具版本。

Navigator 是 conda 的 GUI 伴侣。如果你喜欢更直观的方式来查找包和管理环境，那么这是你的事情。您将获得其姊妹 CLI 中的大多数主要功能。

Python 虚拟环境是我大力提倡的另一个工具。根据您正在使用的项目，很多时候您可能需要同一工具的不同版本。最常见的就是 Python 本身。Python 2 和 3 之间有一些重大的变化，因此，一些项目需要其中一个版本。Conda 也解决了这个问题，它允许您创建虚拟环境来包含不同的包。我们将在下一章讨论如何做到这一点。

还有其他类型的工具，我不太坚持己见，总的来说，这本书在使用哪种工具方面更轻松，但有这么多其他选择，我会使用 conda，稍后再担心其他事情。在 conda 为您处理的事情中，前面提到的依赖性管理可能是最有效的。现在让我们看看依赖是如何工作的，以及为什么最好让 conda 来解决这个问题。

## 如何处理 conda 的依赖性

依赖性管理可能很复杂，所以让我们用一个假设的烹饪例子来看看挑战可能来自哪里。你想做千层面，它需要以下原料:

*   3-4 周的切达干酪
*   1%或 2%的牛奶
*   碎牛肉

首先，你拿一些三周的切达干酪。然而，你的牛奶只能和刚好 4 周的切达干酪混合。所以，你需要回去换掉你的奶酪。但是，当你使用 2%的牛奶时，你会发现你想用的肉变坏了(这毫无意义)，1%的牛奶需要不同年份的切达干酪……但是，你会发现你还需要一张优惠券，以确保你把它保持在预算之内。你对此一无所知，而且它甚至没有意义的限制在那里！很困惑，对吧？！没错。依赖关系可能是一场噩梦，你应该关注更重要的问题。

如果你让你的私人购物者去搞清楚这一切呢？这就是包管理器为你做的，列出你需要的每样东西，并为你分类。你只需要说*我想做千层面*。找到一个好的依赖管理器并使用它。Conda 是这些良好的依赖管理器之一，而 pip 是另一个。利用它，专注于做美味的千层面。Conda 更受青睐，原因我们稍后再谈。

举一个更真实的例子，看看科学计算的一个非常流行的工具 **scikit-learn 1.0.0** 的主要依赖项:

*   Python (>= 3.7)
*   数字(> = 1.14.6)
*   SciPy(>
    *   `numpy` > = 1.11.3，< 2、
    *   `libcxx` > = 4.0.1
    *   `python` > = 3.7，< 3.8
    *   `libopenblas` > = 0.2.20，< 0.2.21
*   Joblib (>= 0.11)
*   threadpoolctl (>= 2.0.0)
*   Matplotlib (>= 1.1):
    *   `dateutil`
    *   `pytz`

如您所见，scikit-learn 需要许多依赖项，不仅如此，一些依赖项还需要引入其他依赖项来完成它们需要的工作，例如 SciPy 需要 NumPy。

需要不同包的一个可能发生的事情是，你可能有不同版本的某些包被引入。解决这个问题的一个方法是使用不同的空间来存放你在某个项目中需要的特定物品。Anaconda 对此有一个解决方案,叫做环境，我们将在下一节看看这些。

## 使用 Anaconda 环境创建独立的工作区

虚拟环境是一种创建封闭系统的方式，您可以自由调整，而不会影响主机系统。把它们想象成一个你可以去的弹出式厨房，你可以把它弄得一团糟，在搅拌机里尝试疯狂的食谱，然后在别人打扫的时候离开，而你的房子却从未被碰过。

记得我说过蟒蛇是首选吗？这是因为虚拟环境是固定的，您可以只使用一个工具来进行依赖性管理和包管理。

一旦你安装了它，你应该创建一个虚拟环境，这样任何安装的东西都可以有一个自己的好地方，不会干扰任何其他安装的库和包。虚拟环境是一个需要掌握的重要概念，所以这里值得深入研究一下细节。下载 Anaconda 后，在 macOS 中打开终端，或者在 Windows 中运行 Anaconda PowerShell 脚本，并运行以下命令:

```py
conda create -n myenv Python=3.8
```

这就用 Python 3.8 创建了`myenv`环境。然后，您可以用下面的命令*激活*这个环境:

```py
conda activate myenv
```

*激活*环境简单来说就是*嘿，我想在这里跳进去运行命令*。此时，任何安装、升级或降级的包都不会影响您的本地机器或其他可能需要安装的库。

重要说明

conda 的早期版本有特定于平台的命令，而新版本允许相同的命令在所有支持的平台上工作。在写这本书的时候，这是 OSX (Mac)、Windows 10 和 Linux。

Python 虚拟环境的主要区别在于，conda 是语言无关的，因此它提供了更大的灵活性，如果您的需求发生变化，并且您需要使用 R 或任何其他语言，它也不会受到限制。

你不会局限于开箱即用的大约 250 个软件包。根据需要安装额外的软件包很简单。有 7500 多个可以从 repo.anaconda.com 安装，还有成千上万个可以从 conda-forge 安装。

现在您已经在虚拟环境中，运行下面的命令来安装`numpy`:

```py
conda install numpy
```

NumPy 是一个帮助你在数组上执行许多数学运算的库。你现在不必了解它，但我们会在第四章*使用 Jupyter 笔记本和 NumPy* 中详细讨论它。

如果您需要帮助或者想要了解更多，您可以使用 conda help 命令来显示关于您可以从命令行做什么的有用信息:

```py
conda help
```

你也可以直接进入源代码，在这里获得来自 Anaconda 本身的提示和指南:[https://docs . Anaconda . com/Anaconda/user-guide/getting-started/](https://docs.anaconda.com/anaconda/user-guide/getting-started/)。

如果你是视觉型的，你也可以选择使用导航器。虽然不如命令行工具强大，但 Navigator 使最常用的命令在可能更熟悉的 GUI 界面中可用。

我们将在后面的章节中更深入地研究 conda、包管理、虚拟环境和 Navigator。

# 总结

正如你所看到的，在 AI/ML 世界中有很多东西需要讨论，我们只是触及了底层的表面。

在这一章中，我们讲述了一点 AI/ML 的历史，以便理解我们是如何走到这一步的。我们也看到了大量数据如何通过廉价的存储和更多的来源来创造人工智能革命。商业价值也是推动这项技术向前发展的主要动力，我们看到了一些公司，如网飞和谷歌，如何利用它来解决不同的问题。谈到过时的模型，我们了解了什么是漂移，以及随着现实世界的变化，漂移如何影响您对生产数据进行一致预测的能力。最后，我们通过使用 Anaconda 的包管理器 conda 安装包，获得了更多的实践机会。

有了这些知识，您现在就能够区分不同的模型和问题类型，以便在某些情况下使用，包括有人监督和无人监督的情况。你也将能够知道在线学习和批量学习之间的权衡是否值得，并能够确定哪一个适合你。最后，您现在应该能够安装 Anaconda 个人版，并使用它来创建环境和下载本书剩余部分所需的包。

在我们的下一章中，你将学到你需要知道的关于人工智能基石的一切:开源。您将获得使用最流行的工具 NumPy 和 pandas 的实践经验，了解开源社区以及如何参与，并练习如何使用 conda 和 conda-forge 社区在几秒钟内将您需要的任何东西导入到您的项目中。